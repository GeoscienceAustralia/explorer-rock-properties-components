var rpComponents;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,o,r,i,s,n,l,c){this.count=e,this.lat=t,this.lon=o,this.elev=r,this.lithologyGroup=i,this.property=s,this.provinceName=n,this.sampleType=l,this.stratigraphicUnitName=c}return e.$inject=["count","lat","lon","elev","lithologyGroup","property","provinceName","sampleType","stratigraphicUnitName"],e}();e.Cluster=t}(t=e.cluster||(e.cluster={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(t){"use strict";var o=function(){function e(e,t,o){this.$http=e,this.$rootScope=t,this.zoomLevelService=o}return e.prototype.init=function(e,t){this.viewer=e,this.zoomLevelService.viewer=e,this.serviceUrl=t},e.prototype.toggleClusters=function(){this.clustersCollection?(this.clustersCollection.show=!this.clustersCollection.show,this.zoomLevelService.setActive(this.clustersCollection.show)):(this.clustersCollection=new Cesium.PrimitiveCollection,this.viewer.scene.primitives.add(this.clustersCollection),this.addClusters(),this.zoomLevelService.setActive(!0))},e.prototype.getClusters=function(){return this.$http.get(this.serviceUrl+"clusters")},e.prototype.addClusters=function(){var e=this,t=[],o=new Cesium.LabelCollection;this.getClusters().then(function(r){if(r.data){for(var i=r.data,s=0;s<i.length;s++)t.push(e.buildSphereInstance(i[s])),o.add(e.buildLabel(i[s]));e.drawClusters(t,o)}else console.log("got no clusters")})},e.prototype.drawClusters=function(e,t){this.clustersCollection.add(new Cesium.Primitive({geometryInstances:e,appearance:new Cesium.PerInstanceColorAppearance({translucent:!0,closed:!0})})),this.clustersCollection.add(t)},e.prototype.buildSphereInstance=function(e){var t=this.computeClusterAttributes(e.count),o=Cesium.Cartesian3.fromDegrees(e.lon,e.lat),r=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(o),new Cesium.Cartesian3(e.lon,e.lat,e.elev+t.size),new Cesium.Matrix4),i=new Cesium.SphereGeometry({vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,radius:t.size}),s=new Cesium.GeometryInstance({geometry:i,modelMatrix:r,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(t.color)}});return s},e.prototype.buildLabel=function(e){var t=this.computeClusterAttributes(e.count);return{position:Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.elev+20+2*t.size),text:e.count.toString(),fillColor:Cesium.Color.BLACK,outlineColor:Cesium.Color.RED,font:"30px arial, sans-serif",horizontalOrigin:Cesium.HorizontalOrigin.CENTER}},e.prototype.computeClusterAttributes=function(e){return 10>e?{size:6e4,color:Cesium.Color.fromCssColorString("#4781cd").withAlpha(.5)}:e>=10&&250>e?{size:8e4,color:Cesium.Color.fromCssColorString("#0fc70e").withAlpha(.5)}:{size:9e4,color:Cesium.Color.fromCssColorString("#ff0000").withAlpha(.5)}},e.$inject=["$http","$rootScope","zoomLevelService"],e}();t.ClusterService=o,angular.module("explorer.rockproperties.clusters",[]).factory("clusterService",["$http","$rootScope","zoomLevelService",function(t,o,r){return new e.clusterService.ClusterService(t,o,r)}])}(t=e.clusterService||(e.clusterService={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(t){"use strict";var o=function(){function e(e){var t=this;this.$rootScope=e,this.moveEndHandler=function(){console.log(Cesium.Ellipsoid.WGS84.cartesianToCartographic(t.viewer.camera.position).height)}}return e.prototype.setActive=function(e){e?this.viewer.camera.moveEnd.addEventListener(this.moveEndHandler):this.viewer.camera.moveEnd.removeEventListener(this.moveEndHandler)},e.$inject=["$rootScope"],e}();t.ZoomLevelService=o,angular.module("explorer.rockproperties.zoom",[]).factory("zoomLevelService",["$rootScope",function(t){return new e.zoom.ZoomLevelService(t)}])}(t=e.zoom||(e.zoom={}))}(rpComponents||(rpComponents={}));
//# sourceMappingURL=explorer-rock-properties-components.min.js.map
