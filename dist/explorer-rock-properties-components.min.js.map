{"version":3,"sources":["components/charts.ts","explorer-rock-properties-components.min.js","components/cluster.ts","components/clusters.ts","components/spinner.ts","components/zoom.ts","templates/templates.ts"],"names":["rpComponents","rpComponents.chartService","rpComponents.chartService.ClusterChartCtrl","rpComponents.chartService.ClusterChartCtrl.constructor","rpComponents.chartService.ClusterChartService","rpComponents.chartService.ClusterChartService.constructor","rpComponents.chartService.ClusterChartService.hideChart","rpComponents.chartService.ClusterChartService.buildChart","rpComponents.chartService.ClusterChartService.buildChart.drawLegend","width","i","legendWidth","legendSpacing","height","color","d","attributeName","charSpace","radius","length","substring","total","d3","sum","property","data","map","count","Math","round","rpComponents.chartService.ClusterChartService.buildChart.prevLegend","rpComponents.chartService.ClusterChartService.buildChart.nextLegend","this","_current","percent","tooltip","select","html","style","x","event","pageX","panelWidth","y","pageY","document","body","clientHeight","getElementById","display","templateUrl","controller","ClusterChartCtrl","controllerAs","rpComponents.cluster","rpComponents.cluster.Cluster","rpComponents.cluster.Cluster.constructor","rpComponents.clusterService","rpComponents.clusterService.ClusterService","rpComponents.clusterService.ClusterService.constructor","rpComponents.clusterService.ClusterService.init","rpComponents.clusterService.ClusterService.toggleClusters","rpComponents.clusterService.ClusterService.getClusters","rpComponents.clusterService.ClusterService.queryCluster","rpComponents.clusterService.ClusterService.drawClusters","rpComponents.clusterService.ClusterService.buildSphereInstance","rpComponents.clusterService.ClusterService.buildLabel","rpComponents.clusterService.ClusterService.computeClusterAttributes","rpComponents.spinnerService","rpComponents.spinnerService.ChartSpinnerService","rpComponents.spinnerService.ChartSpinnerService.addSpinner","spin","selection","duration","interpolateString","min","config","tau","PI","arc","svg","innerRadius","outerRadius","startAngle","container","append","attr","id","datum","endAngle","call","rpComponents.zoom","rpComponents.zoom.ZoomLevelService","rpComponents.zoom.ZoomLevelService.constructor","rpComponents.zoom.ZoomLevelService.getIndex","rpComponents.zoom.ZoomLevelService.setActive","rpComponents.zoom.ZoomLevelService.getViewExtent","angular","module","run","$templateCache","put"],"mappings":"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","file":"explorer-rock-properties-components.min.js","sourceRoot":"/source/","sourcesContent":[null,"var rpComponents;!function(e){var t;!function(t){\"use strict\";var r=function(){function e(e,t){this.$scope=e,this.clusterChartService=t}return e.$inject=[\"$scope\",\"clusterChartService\"],e}();t.ClusterChartCtrl=r;var n=function(){function e(e,t){this.$http=e,this.$rootScope=t}return e.prototype.hideChart=function(){this.$rootScope.$broadcast(\"chart.update\",{targetChartId:!1})},e.prototype.buildChart=function(e){document.getElementById(\"cluster-summary-chart-d3\").innerHTML=\"\",this.$rootScope.$broadcast(\"chart.update\",{targetChartId:\"clusterSummaryChart\"}),d3.json(\"resources/mock-service/explorer-cossap-services/service/rock-properties/clusters/cluster.json\",function(e,t){var r,n,o,i,s=1250,a=255,c=t.length<7?t.length:4;.35*document.body.clientHeight>a&&document.body.clientWidth>s?(o={top:0,right:10,bottom:0,left:10},r=document.body.clientWidth/c-(2*o.left+o.right),n=.35*document.body.clientHeight,i=20):(o={top:0,right:5,bottom:0,left:5},r=s/c-(2*o.left+o.right),n=a,i=15);var l=document.body.clientWidth-(2*o.left+o.right),u=Math.min(r,n)/2;t.forEach(function(e){function t(t,o,i,l){var h=p.selectAll(\"g.legendg\").data(t).enter().append(\"g\").attr(\"class\",\"legendg\").attr(\"transform\",function(e,t){return\"translate(\"+-(r/2.3)+\",\"+(t*(S+x)-n/4)+\")\"}),d=h.append(\"rect\").attr(\"x\",45).attr(\"width\",S).attr(\"height\",S).attr(\"class\",\"legend\").style(\"fill\",function(e,t){return c(e.attributeName)}),m=h.append(\"text\").attr(\"x\",65).attr(\"y\",6).attr(\"dy\",\".35em\").style(\"text-anchor\",\"start\").text(function(e){var t=(u-20)/5;return e.attributeName.length>t?e.attributeName.substring(0,t)+\"...\":e.attributeName});if(d.append(\"svg:title\").text(function(t){var r=d3.sum(e.data.map(function(e){return e.count}));return t.attributeName+\" (\"+Math.round(1e3*t.count/r)/10+\"%)\"}),m.append(\"svg:title\").text(function(t){var r=d3.sum(e.data.map(function(e){return e.count}));return t.attributeName+\" (\"+Math.round(1e3*t.count/r)/10+\"%)\"}),l>1){var v=p.append(\"g\").attr(\"class\",\"pageNo\").attr(\"transform\",\"translate(-10,\"+((o+1)*(S+x)-n/4)+\")\");v.append(\"text\").text(i+\"/\"+l).attr(\"dx\",\".25em\");var C=p.append(\"g\").attr(\"class\",\"prev\").attr(\"transform\",\"translate(-20,\"+((o+1.5)*(S+x)-n/4)+\")\").on(\"click\",s).style(\"cursor\",\"pointer\"),g=p.append(\"g\").attr(\"class\",\"next\").attr(\"transform\",\"translate(0,\"+((o+1.5)*(S+x)-n/4)+\")\").on(\"click\",a).style(\"cursor\",\"pointer\");g.append(\"polygon\").style(\"stroke\",\"#000\").style(\"fill\",\"#000\").attr(\"points\",\"0,0, 20,0, 10,10\"),C.append(\"polygon\").style(\"stroke\",\"#000\").style(\"fill\",\"#000\").attr(\"points\",\"0,10, 20,10, 10,0\"),i==l?(g.style(\"opacity\",\"0.3\"),g.on(\"click\",\"\").style(\"cursor\",\"\")):1==i&&(C.style(\"opacity\",\"0.3\"),C.on(\"click\",\"\").style(\"cursor\",\"\"))}}function s(){f--,p.selectAll(\"g.legendg\").remove(),p.select(\".pageNo\").remove(),p.select(\".prev\").remove(),p.select(\".next\").remove();for(var r=(f-1)*C,n=r+C,o=[],i=0;i<e.data.length;i++)i>=r&&n>i&&o.push(e.data[i]);t(o,C,f,g)}function a(){f++,p.selectAll(\"g.legendg\").remove(),p.select(\".pageNo\").remove(),p.select(\".prev\").remove(),p.select(\".next\").remove();for(var r=(f-1)*C,n=r+C,o=[],i=0;i<e.data.length;i++)i>=r&&n>i&&o.push(e.data[i]);t(o,C,f,g)}var c=d3.scale.category20(),p=d3.select(\"#cluster-summary-chart-d3\").append(\"svg\").attr(\"width\",r).attr(\"height\",n).style(\"margin-left\",o.left+\"px\").style(\"margin-right\",o.right+\"px\").append(\"g\").attr(\"transform\",\"translate(\"+r/2+\",\"+(n/2+10)+\")\"),h=d3.svg.arc().innerRadius(u-i).outerRadius(u),d=d3.layout.pie().value(function(e){return e.count}).sort(null),m=d3.select(\"#cluster-summary-chart-d3\").append(\"div\").attr(\"class\",\"cluster-summary-tooltip\");m.append(\"div\").attr(\"class\",\"attribute\"),m.append(\"div\").attr(\"class\",\"count\"),m.append(\"div\").attr(\"class\",\"percent\");var v=p.selectAll(\"path\").data(d(e.data)).enter().append(\"path\").attr(\"d\",h).attr(\"fill\",function(e,t){return c(e.data.attributeName)}).each(function(e){this._current=e});v.on(\"mouseover\",function(t){var r=d3.sum(e.data.map(function(e){return e.count})),n=Math.round(1e3*t.data.count/r)/10;m.select(\".attribute\").html(t.data.attributeName),m.select(\".count\").html(\"Count: \"+t.data.count),m.select(\".percent\").html(\"Percent: \"+n+\"%\"),m.style(\"display\",\"block\")}),v.on(\"mouseout\",function(){m.style(\"display\",\"none\")}),v.on(\"mousemove\",function(e){var t=d3.event.pageX>l-180?d3.event.pageX-180:d3.event.pageX,r=d3.event.pageY>document.body.clientHeight-120?d3.event.pageY-100:d3.event.pageY+10;m.style(\"top\",r+\"px\").style(\"left\",t+\"px\")}),p.append(\"g\").attr(\"class\",\"cluster-summary-chart-title\").append(\"text\").attr(\"x\",0).attr(\"y\",-(n/2+7)).attr(\"dy\",\".71em\").style(\"text-anchor\",\"middle\").style(\"fill\",\"#000\").style(\"font-weight\",\"bold\").text(e.propertyName);var C,g,f,y=e.data.length,S=15,x=6,w=(S+x)*y;if(w/u>1){C=Math.floor(u/(S+x)),g=Math.ceil(y/C),f=1;for(var b=(f-1)*C,I=b+C,E=[],$=0;$<e.data.length;$++)$>=b&&I>$&&E.push(e.data[$]);t(E,C,f,g)}else t(e.data,Math.floor(u/(S+x)),1,1)})}),document.getElementById(\"cluster-summary-chart-d3\").style.display=\"none\",setTimeout(function(){document.getElementById(\"cluster-summary-chart-loading\").style.display=\"none\",document.getElementById(\"cluster-summary-chart-d3\").style.display=\"block\"},2e3)},e.$inject=[\"$http\",\"$rootScope\"],e}();t.ClusterChartService=n,angular.module(\"explorer.rockproperties.charts\",[]).factory(\"clusterChartService\",[\"$http\",\"$rootScope\",function(t,r){return new e.chartService.ClusterChartService(t,r)}]).controller(\"clusterChartCtrl\",r).directive(\"clusterChartSummary\",function(){return{templateUrl:\"rockprops/cluster-summary.html\",controller:r,controllerAs:\"clusterChartVM\"}})}(t=e.chartService||(e.chartService={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(e){\"use strict\";var t=function(){function e(e,t,r,n,o,i,s,a,c){this.count=e,this.lat=t,this.lon=r,this.elev=n,this.lithologyGroup=o,this.property=i,this.provinceName=s,this.sampleType=a,this.stratigraphicUnitName=c}return e.$inject=[\"count\",\"lat\",\"lon\",\"elev\",\"lithologyGroup\",\"property\",\"provinceName\",\"sampleType\",\"stratigraphicUnitName\"],e}();e.Cluster=t}(t=e.cluster||(e.cluster={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(t){\"use strict\";var r=function(){function e(e,t,r,n,o){var i=this;this.$http=e,this.$rootScope=t,this.zoomLevelService=r,this.clusterChartService=n,this.chartSpinnerService=o,this.reCluster=function(){var e=[],t=new Cesium.LabelCollection;i.getClusters().then(function(r){if(r.data){for(var n=r.data,o=0;o<n.length;o++)e.push(i.buildSphereInstance(n[o])),t.add(i.buildLabel(n[o]));i.drawClusters(e,t)}else console.log(\"got no clusters\")})}}return e.prototype.init=function(e,t,r){var n=this;if(this.viewer=e,this.zoomLevelService.viewer=e,this.serviceUrl=t,this.$rootScope.$on(\"rocks.clusters.update\",function(){n.reCluster()}),r){var o=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);o.setInputAction(function(e){var t=n.viewer.scene.pick(e.position);Cesium.defined(t)&&n.queryCluster(t.id)},Cesium.ScreenSpaceEventType.LEFT_CLICK)}},e.prototype.toggleClusters=function(){this.clustersCollection?(this.clustersCollection.show=!this.clustersCollection.show,this.zoomLevelService.setActive(this.clustersCollection.show),this.reCluster()):(this.clustersCollection=new Cesium.PrimitiveCollection,this.viewer.scene.primitives.add(this.clustersCollection),this.zoomLevelService.setActive(!0),this.reCluster())},e.prototype.getClusters=function(){return this.$http({method:\"GET\",url:this.serviceUrl+this.zoomLevelService.nextIndex+\".json\",headers:{\"Content-Type\":\"application/json\"},data:{heightIndex:this.zoomLevelService.nextIndex,extent:this.zoomLevelService.getViewExtent(100)}})},e.prototype.queryCluster=function(e){var t=this;this.summarySpinner?document.getElementById(\"cluster-summary-chart-loading\").style.display=\"block\":(this.summarySpinner=this.chartSpinnerService.addSpinner({width:100,height:100,container:\"#cluster-summary-chart-loading\",id:\"chart-spinner\"}),this.summarySpinner()),this.$http({method:\"GET\",url:this.serviceUrl+\"cluster-summary.json\",headers:{\"Content-Type\":\"application/json\"},data:{targetCluster:e}}).then(function(e){e.hasOwnProperty(\"data\")&&t.clusterChartService.buildChart(e.data)})},e.prototype.drawClusters=function(e,t){this.clustersCollection.removeAll(),this.clustersCollection.add(new Cesium.Primitive({geometryInstances:e,appearance:new Cesium.PerInstanceColorAppearance({translucent:!0,closed:!0})})),this.clustersCollection.add(t)},e.prototype.buildSphereInstance=function(e){var t=this.computeClusterAttributes(e.count),r=Cesium.Cartesian3.fromDegrees(e.lon,e.lat),n=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(r),new Cesium.Cartesian3(e.lon,e.lat,t.size),new Cesium.Matrix4),o=new Cesium.SphereGeometry({vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,radius:t.size}),i=new Cesium.GeometryInstance({geometry:o,modelMatrix:n,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(t.color)},id:e});return i},e.prototype.buildLabel=function(e){var t=this.computeClusterAttributes(e.count);return{position:Cesium.Cartesian3.fromDegrees(e.lon,e.lat,20+2*t.size),text:e.count.toString(),fillColor:Cesium.Color.BLACK,outlineColor:Cesium.Color.RED,font:\"30px arial, sans-serif\",horizontalOrigin:Cesium.HorizontalOrigin.CENTER}},e.prototype.computeClusterAttributes=function(e){return 10>e?{size:1e4*this.zoomLevelService.nextIndex,color:Cesium.Color.fromCssColorString(\"#4781cd\").withAlpha(.5)}:e>=10&&1e3>e?{size:1e4*this.zoomLevelService.nextIndex,color:Cesium.Color.fromCssColorString(\"#0fc70e\").withAlpha(.5)}:{size:1e4*this.zoomLevelService.nextIndex,color:Cesium.Color.fromCssColorString(\"#ff0000\").withAlpha(.5)}},e.$inject=[\"$http\",\"$rootScope\",\"zoomLevelService\",\"clusterChartService\",\"chartSpinnerService\"],e}();t.ClusterService=r,angular.module(\"explorer.rockproperties.clusters\",[]).factory(\"clusterService\",[\"$http\",\"$rootScope\",\"zoomLevelService\",\"clusterChartService\",\"chartSpinnerService\",function(t,r,n,o,i){return new e.clusterService.ClusterService(t,r,n,o,i)}])}(t=e.clusterService||(e.clusterService={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(t){\"use strict\";var r=function(){function e(){}return e.prototype.addSpinner=function(e){return function(){function t(e,r){e.transition().ease(\"linear\").duration(r).attrTween(\"transform\",function(){return d3.interpolateString(\"rotate(0)\",\"rotate(360)\")}),setTimeout(function(){t(e,r)},r)}var r=Math.min(e.width,e.height)/2,n=2*Math.PI,o=d3.svg.arc().innerRadius(.5*r).outerRadius(.9*r).startAngle(0),i=d3.select(e.container).append(\"svg\").attr(\"id\",e.id).attr(\"width\",e.width).attr(\"height\",e.height).append(\"g\").attr(\"transform\",\"translate(\"+e.width/2+\",\"+e.height/2+\")\");i.append(\"path\").datum({endAngle:.33*n}).style(\"fill\",\"#4D4D4D\").attr(\"d\",o).call(t,1500)}},e}();t.ChartSpinnerService=r,angular.module(\"explorer.rockproperties.spinner\",[]).factory(\"chartSpinnerService\",[function(){return new e.spinnerService.ChartSpinnerService}])}(t=e.spinnerService||(e.spinnerService={}))}(rpComponents||(rpComponents={}));var rpComponents;!function(e){var t;!function(t){\"use strict\";var r=function(){function e(e){var t=this;this.$rootScope=e,this.zoomLevels=[5e3,1e4,2e4,4e4,75e4,15e5,25e5,35e5,55e5,65e5,8e6],this.defaultExtent={west:109,south:-45,east:158,north:-8},this.moveEndHandler=function(){t.nextIndex=t.getIndex(Cesium.Ellipsoid.WGS84.cartesianToCartographic(t.viewer.camera.position).height),t.previousIndex>-1&&t.previousIndex!=t.nextIndex&&t.$rootScope.$broadcast(\"rocks.clusters.update\",t.nextIndex),t.previousIndex=t.nextIndex}}return e.prototype.getIndex=function(e){for(var t=0;t<this.zoomLevels.length;t++)if(e<this.zoomLevels[t])return t;return this.zoomLevels.length-1},e.prototype.setActive=function(e){e?(this.previousIndex=this.getIndex(Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.viewer.camera.position).height),this.nextIndex=this.previousIndex,this.viewer.camera.moveEnd.addEventListener(this.moveEndHandler)):this.viewer.camera.moveEnd.removeEventListener(this.moveEndHandler)},e.prototype.getViewExtent=function(e){var t=Cesium.Ellipsoid.WGS84,r=window.devicePixelRatio||1,n=new Cesium.Cartesian2(-e,-e),o=this.viewer.scene.camera.pickEllipsoid(n,t);n=new Cesium.Cartesian2(this.viewer.scene.canvas.width/r+e,this.viewer.scene.canvas.height/r+e);var i=this.viewer.scene.camera.pickEllipsoid(n,t);return null!=o&&null!=i?(o=t.cartesianToCartographic(o),i=t.cartesianToCartographic(i),o.longitude>i.longitude?this.defaultExtent:{west:Cesium.Math.toDegrees(o.longitude),south:Cesium.Math.toDegrees(i.latitude),east:Cesium.Math.toDegrees(i.longitude),north:Cesium.Math.toDegrees(o.latitude)}):this.defaultExtent},e.$inject=[\"$rootScope\"],e}();t.ZoomLevelService=r,angular.module(\"explorer.rockproperties.zoom\",[]).factory(\"zoomLevelService\",[\"$rootScope\",function(t){return new e.zoom.ZoomLevelService(t)}])}(t=e.zoom||(e.zoom={}))}(rpComponents||(rpComponents={})),angular.module(\"explorer.rockproperties.templates\",[]).run([\"$templateCache\",function(e){e.put(\"rockprops/cluster-summary.html\",'<div id=\"clusterSummaryChart\" ng-show=\"cossapChartState.targetChartId == \\'clusterSummaryChart\\'\">\\n\\n\t<div class=\"btn-group\" style=\"position: absolute;right: 10px;top: 10px;\">\\n\t\t<button type=\"button\" class=\"btn btn-default\" title=\"Close graphs\" ng-click=\"clusterChartVM.clusterChartService.hideChart()\">\\n\t\t\t<i class=\"fa fa-times-circle\" role=\"presentation\" style=\"font-size:16px; color:black\"></i>\\n\t\t</button>\\n\t</div>\\n\\n\\n\t<div id=\"cluster-summary-chart-d3\"></div>\\n\\n\t<div id=\"cluster-summary-chart-loading\"></div>\\n\\n</div>')}]);\n//# sourceMappingURL=explorer-rock-properties-components.min.js.map\n"]}